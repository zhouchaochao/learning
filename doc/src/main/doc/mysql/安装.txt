
ä½¿ç”¨HomeBrewå®‰è£…MySQL
IT-C02Z1186LVDL:~ cc$ brew info mysql@5.7
mysql@5.7: stable 5.7.27 (bottled) [keg-only]
Open source relational database management system
https://dev.mysql.com/doc/refman/5.7/en/
Not installed
From: https://github.com/Homebrew/homebrew-core/blob/master/Formula/mysql@5.7.rb
==> Dependencies
Build: cmake âœ˜
Required: openssl âœ”
==> Caveats
We've installed your MySQL database without a root password. To secure it run:
    mysql_secure_installation

MySQL is configured to only allow connections from localhost by default

To connect run:
    mysql -uroot

mysql@5.7 is keg-only, which means it was not symlinked into /usr/local,
because this is an alternate version of another formula.


To have launchd start mysql@5.7 now and restart at login:
  brew services start mysql@5.7
Or, if you don't want/need a background service you can just run:
  /usr/local/opt/mysql@5.7/bin/mysql.server start


å®‰è£…
IT-C02Z1186LVDL:~ cc$ brew install mysql@5.7
Updating Homebrew...
==> Auto-updated Homebrew!
==> Pouring mysql@5.7-5.7.27.mojave.bottle.tar.gz
==> /usr/local/Cellar/mysql@5.7/5.7.27/bin/mysqld --initialize-insecure --user=cc --basedir=/usr/local/Cellar/mysql@5.7/5.7.27 --datadir=/usr/local/var/mysql --tmpdir=/tmp
^@==> Caveats
We've installed your MySQL database without a root password. To secure it run:
    mysql_secure_installation

MySQL is configured to only allow connections from localhost by default

To connect run:
    mysql -uroot

mysql@5.7 is keg-only, which means it was not symlinked into /usr/local,
because this is an alternate version of another formula.

If you need to have mysql@5.7 first in your PATH run:
  echo 'export PATH="/usr/local/opt/mysql@5.7/bin:$PATH"' >> ~/.bash_profile

For compilers to find mysql@5.7 you may need to set:
  export LDFLAGS="-L/usr/local/opt/mysql@5.7/lib"
  export CPPFLAGS="-I/usr/local/opt/mysql@5.7/include"


To have launchd start mysql@5.7 now and restart at login:
  brew services start mysql@5.7
Or, if you don't want/need a background service you can just run:
  /usr/local/opt/mysql@5.7/bin/mysql.server start
==> Summary
ğŸº  /usr/local/Cellar/mysql@5.7/5.7.27: 320 files, 232.3MB


é…ç½®ç¯å¢ƒå˜é‡
export PATH="/usr/local/opt/mysql@5.7/bin:$PATH"
IT-C02Z1186LVDL:~ cc$ source .bash_profile

å¯åŠ¨MySQL
IT-C02Z1186LVDL:bin cc$ mysql.server start
Starting MySQL
. SUCCESS!

IT-C02Z1186LVDL:bin cc$ mysql.server stop
Shutting down MySQL
. SUCCESS!

è¿›è¡Œå®‰å…¨è®¾ç½®ï¼ˆè®¾ç½®rootç”¨æˆ·åå¯†ç ï¼Œè¿è¡Œè¿œç¨‹è¿æ¥ï¼‰
IT-C02Z1186LVDL:bin cc$ mysql_secure_installation

ä½¿ç”¨å®¢æˆ·ç«¯è¿æ¥ï¼ˆç›®å‰åªèƒ½åœ¨æœ¬æœºä¸Šé€šè¿‡127.0.0.1ï¼Œå¦‚æœéœ€è¦è¿œç¨‹è¿æ¥ï¼Œåé¢è¿˜éœ€è¦é…ç½®ï¼‰
IT-C02Z1186LVDL:~ cc$ mysql -h 127.0.0.1 -uroot -p123456 -P3306

=====================================================================================
é…ç½®å…è®¸è¿œç¨‹è¿æ¥ï¼Œé€šè¿‡GRANTæˆæƒ
$mysql -h localhost -uroot -p123456 -P3306

mysql> use mysql

mysql> select * from user;
+-----------+---------------+-------------+-------------+-------------+-------------+-------------+-----------+-------------+---------------+--------------+-----------+------------+-----------------+------------+------------+--------------+------------+-----------------------+------------------+--------------+-----------------+------------------+------------------+----------------+---------------------+--------------------+------------------+------------+--------------+------------------------+----------+------------+-------------+--------------+---------------+-------------+-----------------+----------------------+-----------------------+-------------------------------------------+------------------+-----------------------+-------------------+----------------+
| Host      | User          | Select_priv | Insert_priv | Update_priv | Delete_priv | Create_priv | Drop_priv | Reload_priv | Shutdown_priv | Process_priv | File_priv | Grant_priv | References_priv | Index_priv | Alter_priv | Show_db_priv | Super_priv | Create_tmp_table_priv | Lock_tables_priv | Execute_priv | Repl_slave_priv | Repl_client_priv | Create_view_priv | Show_view_priv | Create_routine_priv | Alter_routine_priv | Create_user_priv | Event_priv | Trigger_priv | Create_tablespace_priv | ssl_type | ssl_cipher | x509_issuer | x509_subject | max_questions | max_updates | max_connections | max_user_connections | plugin                | authentication_string                     | password_expired | password_last_changed | password_lifetime | account_locked |
+-----------+---------------+-------------+-------------+-------------+-------------+-------------+-----------+-------------+---------------+--------------+-----------+------------+-----------------+------------+------------+--------------+------------+-----------------------+------------------+--------------+-----------------+------------------+------------------+----------------+---------------------+--------------------+------------------+------------+--------------+------------------------+----------+------------+-------------+--------------+---------------+-------------+-----------------+----------------------+-----------------------+-------------------------------------------+------------------+-----------------------+-------------------+----------------+
| localhost | root          | Y           | Y           | Y           | Y           | Y           | Y         | Y           | Y             | Y            | Y         | Y          | Y               | Y          | Y          | Y            | Y          | Y                     | Y                | Y            | Y               | Y                | Y                | Y              | Y                   | Y                  | Y                | Y          | Y            | Y                      |          |            |             |              |             0 |           0 |               0 |                    0 | mysql_native_password | *6BB4837EB74329105EE4568DDA7DC67ED2CA2AD9 | N                | 2019-09-10 15:44:47   |              NULL | N              |
| localhost | mysql.session | N           | N           | N           | N           | N           | N         | N           | N             | N            | N         | N          | N               | N          | N          | N            | Y          | N                     | N                | N            | N               | N                | N                | N              | N                   | N                  | N                | N          | N            | N                      |          |            |             |              |             0 |           0 |               0 |                    0 | mysql_native_password | *THISISNOTAVALIDPASSWORDTHATCANBEUSEDHERE | N                | 2019-09-10 15:32:56   |              NULL | Y              |
| localhost | mysql.sys     | N           | N           | N           | N           | N           | N         | N           | N             | N            | N         | N          | N               | N          | N          | N            | N          | N                     | N                | N            | N               | N                | N                | N              | N                   | N                  | N                | N          | N            | N                      |          |            |             |              |             0 |           0 |               0 |                    0 | mysql_native_password | *THISISNOTAVALIDPASSWORDTHATCANBEUSEDHERE | N                | 2019-09-10 15:32:56   |              NULL | Y              |
+-----------+---------------+-------------+-------------+-------------+-------------+-------------+-----------+-------------+---------------+--------------+-----------+------------+-----------------+------------+------------+--------------+------------+-----------------------+------------------+--------------+-----------------+------------------+------------------+----------------+---------------------+--------------------+------------------+------------+--------------+------------------------+----------+------------+-------------+--------------+---------------+-------------+-----------------+----------------------+-----------------------+-------------------------------------------+------------------+-----------------------+-------------------+----------------+
3 rows in set (0.00 sec)

mysql> GRANT ALL PRIVILEGES ON *.* TO 'root'@'%' IDENTIFIED BY '123456';
Query OK, 0 rows affected, 1 warning (0.00 sec)

mysql> flush privileges;
Query OK, 0 rows affected (0.00 sec)

mysql> select * from user;
+-----------+---------------+-------------+-------------+-------------+-------------+-------------+-----------+-------------+---------------+--------------+-----------+------------+-----------------+------------+------------+--------------+------------+-----------------------+------------------+--------------+-----------------+------------------+------------------+----------------+---------------------+--------------------+------------------+------------+--------------+------------------------+----------+------------+-------------+--------------+---------------+-------------+-----------------+----------------------+-----------------------+-------------------------------------------+------------------+-----------------------+-------------------+----------------+
| Host      | User          | Select_priv | Insert_priv | Update_priv | Delete_priv | Create_priv | Drop_priv | Reload_priv | Shutdown_priv | Process_priv | File_priv | Grant_priv | References_priv | Index_priv | Alter_priv | Show_db_priv | Super_priv | Create_tmp_table_priv | Lock_tables_priv | Execute_priv | Repl_slave_priv | Repl_client_priv | Create_view_priv | Show_view_priv | Create_routine_priv | Alter_routine_priv | Create_user_priv | Event_priv | Trigger_priv | Create_tablespace_priv | ssl_type | ssl_cipher | x509_issuer | x509_subject | max_questions | max_updates | max_connections | max_user_connections | plugin                | authentication_string                     | password_expired | password_last_changed | password_lifetime | account_locked |
+-----------+---------------+-------------+-------------+-------------+-------------+-------------+-----------+-------------+---------------+--------------+-----------+------------+-----------------+------------+------------+--------------+------------+-----------------------+------------------+--------------+-----------------+------------------+------------------+----------------+---------------------+--------------------+------------------+------------+--------------+------------------------+----------+------------+-------------+--------------+---------------+-------------+-----------------+----------------------+-----------------------+-------------------------------------------+------------------+-----------------------+-------------------+----------------+
| localhost | root          | Y           | Y           | Y           | Y           | Y           | Y         | Y           | Y             | Y            | Y         | Y          | Y               | Y          | Y          | Y            | Y          | Y                     | Y                | Y            | Y               | Y                | Y                | Y              | Y                   | Y                  | Y                | Y          | Y            | Y                      |          |            |             |              |             0 |           0 |               0 |                    0 | mysql_native_password | *6BB4837EB74329105EE4568DDA7DC67ED2CA2AD9 | N                | 2019-09-10 15:44:47   |              NULL | N              |
| localhost | mysql.session | N           | N           | N           | N           | N           | N         | N           | N             | N            | N         | N          | N               | N          | N          | N            | Y          | N                     | N                | N            | N               | N                | N                | N              | N                   | N                  | N                | N          | N            | N                      |          |            |             |              |             0 |           0 |               0 |                    0 | mysql_native_password | *THISISNOTAVALIDPASSWORDTHATCANBEUSEDHERE | N                | 2019-09-10 15:32:56   |              NULL | Y              |
| localhost | mysql.sys     | N           | N           | N           | N           | N           | N         | N           | N             | N            | N         | N          | N               | N          | N          | N            | N          | N                     | N                | N            | N               | N                | N                | N              | N                   | N                  | N                | N          | N            | N                      |          |            |             |              |             0 |           0 |               0 |                    0 | mysql_native_password | *THISISNOTAVALIDPASSWORDTHATCANBEUSEDHERE | N                | 2019-09-10 15:32:56   |              NULL | Y              |
| %         | root          | Y           | Y           | Y           | Y           | Y           | Y         | Y           | Y             | Y            | Y         | N          | Y               | Y          | Y          | Y            | Y          | Y                     | Y                | Y            | Y               | Y                | Y                | Y              | Y                   | Y                  | Y                | Y          | Y            | Y                      |          |            |             |              |             0 |           0 |               0 |                    0 | mysql_native_password | *6BB4837EB74329105EE4568DDA7DC67ED2CA2AD9 | N                | 2019-09-10 22:51:01   |              NULL | N              |
+-----------+---------------+-------------+-------------+-------------+-------------+-------------+-----------+-------------+---------------+--------------+-----------+------------+-----------------+------------+------------+--------------+------------+-----------------------+------------------+--------------+-----------------+------------------+------------------+----------------+---------------------+--------------------+------------------+------------+--------------+------------------------+----------+------------+-------------+--------------+---------------+-------------+-----------------+----------------------+-----------------------+-------------------------------------------+------------------+-----------------------+-------------------+----------------+
4 rows in set (0.00 sec)

mysql> exit;
Bye

ä¸Šé¢é€šè¿‡GRANTè®¾ç½®è¿è¡Œè¿œç¨‹è¿æ¥ã€‚
é‡å¯ã€‚

[admin@MACHINE /data/workspace/yuhu/soft]
$mysql.server restart
Shutting down MySQL.... SUCCESS!
Starting MySQL. SUCCESS!

[admin@MACHINE /data/workspace/yuhu/soft]
$mysql -h 11.xx.xx.xx -uroot -p123456 -P3306

mysql>


OKï¼Œé‡å¯åå¯ä»¥é€šè¿‡IPè¿æ¥ã€‚
å¦‚æœä»¥ä¸Šè¿˜æ˜¯ä¸è¡Œï¼Œç»§ç»­è®¾ç½®é…ç½®æ–‡ä»¶my.cnf
=====================================================================================

[admin@MACHINE /data/workspace/yuhu/soft]
$mysql -h 11.xx.xx.xx -uroot -p123456 -P3306
mysql: [Warning] Using a password on the command line interface can be insecure.
ERROR 1130 (HY000): Host 'MACHINE' is not allowed to connect to this MySQL server


ç»§ç»­è®¾ç½®é…ç½®æ–‡ä»¶my.cnfè¿è¡Œè¿œç¨‹è¿æ¥ã€‚
æ‰¾åˆ°é…ç½®æ–‡ä»¶ä½ç½®
find / -name "my.cnf " 2>/dev/null

$cat /home/linuxbrew/.linuxbrew/etc/my.cnf
# Default Homebrew MySQL server config
[mysqld]
# Only allow connections from localhost
bind-address = 127.0.0.1

å‘ç°æœ€åç»‘å®šäº†127.0.0.1è¿™ä¸ªIPã€‚æ³¨é‡Šæ‰æœ€åä¸€è¡Œã€‚
$vim /home/linuxbrew/.linuxbrew/etc/my.cnf

é…ç½®æ–‡ä»¶ä¹Ÿå¯èƒ½åœ¨/usr/local/etc/my.cnf,å¯ä»¥é€šè¿‡findæ‰¾ä¸€ä¸‹ã€‚

é‡å¯MySQL
[admin@MACHINE /data/workspace/yuhu/soft]
$mysql.server restart
Shutting down MySQL. SUCCESS!
Starting MySQL. SUCCESS!

ä½¿ç”¨IPè¿æ¥ï¼Œå¯ä»¥äº†
[admin@MACHINE /data/workspace/yuhu/soft]
$mysql -h 11.xx.xx.xx -uroot -p123456 -P3306
